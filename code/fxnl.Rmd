---
title: "Functional Programming in R"
author: "Ali Taqi"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(purrr)
library(matrixcalc)
# Load files
source(file = "../R/matrices.R")
source(file = "../R/eigen.R")
source(file = "../R/evolve.R")
source(file = "../R/analyze.R")
source(file = "../R/simulate.R")
source(file = "../R/vis.R")
```

```{r}
#replicate(n = 100, .pos_entries(RM_stoch(3, symm = T), T), simplify = T)
#sum(replicate(n = 100, .isStochastic(RM_stoch(3, symm = T)), simplify = T))/100
N <- 5
P <- RM_stoch(N, symm = T)
batch <- generate_batch(N, batch_size = 10, stoch = .isStochastic(P))
steps <- 3
evolved_batch <- evolve_batch(batch, P, steps)
#by.time(evolved_batch, at_time = 20)
```

```{r}
# Extract the array for a particular element/a range of elements
by.element <- function(evolved_batch, index){evolved_batch[which(evolved_batch$element_index %in% c(index)),]}

# Extract the array for a particular time/a range of times
by.time <- function(evolved_batch, at_time){evolved_batch[which(evolved_batch$time %in% c(at_time)),]}
```

```{r}
by.element(evolved_batch, index = 1:2)
by.element(evolved_batch, index = 2)

```


