---
title: "Eigenvectors of Symmetric Matrices"
author: "Ali Taqi"
date: "11/4/2020"
output: pdf_document
header-includes:
  - \newcommand{\R}{\mathbb{R}}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, fig.align = "center", 
                      message = FALSE, warning = FALSE)
library(tidyverse)
library(knitr)
library(patchwork)
library(ggfortify)
library(matrixcalc)
library(zeallot)
# Load files
source(file = "symm_evc.R")
source(file = "../R/eigenmetrics.R")
source(file = "../R/eigenvectors.R")
```

```{r}
S <- RM_symm(8,0.5,10)
prop <- prop_real_rows(eigen_frame = eigen_frame(S))
prop
avgprop_real_components(eigen_frame(S))
```

\newpage

# Simulation

```{r}
simulate_by_f <- function(f,M_max,ep_max,draws){
  M_vec <- sample(1:M_max, draws, replace = T)
  ep_vec <- sample(1:ep_max, draws, replace = F)
  table <- data.frame(M = M_vec, ep = rep(ep_vec,length(M_vec)))

  prop_vec <- rep(NA, length(table$M))

  for(i in 1:length(table$M)){
    S_curr <- RM_symm(table$M[i],f,table$ep[i])
    prop <- avgprop_real_components(eigen_frame(S_curr))
    #print(prop)
    prop_vec[i] <- prop
  }
  cbind(table,prop_vec)
}

plot_f_table <- function(table, f){
  ggplot() + 
    geom_point(data = table, aes(x=M, y=ep, color = prop_vec)) +
    labs(color = "EV Real", title = paste("f = ",f,sep="")) +
    scale_color_gradient(high="blue", low="red")
}
```

```{r}
M <- 15
ep <- 100
d <- ep
```

```{r, cache = T}
f <- 0.5
table <- simulate_by_f(f = f, M_max = M, ep_max = ep, draws = d)
head(table)
plot_f_table(table, f = f)
```

```{r, cache = T}
f <- 0.1
#table <- simulate_by_f(f = f, M_max = M, ep_max = ep, draws = d)
#head(table)
#plot_f_table(table, f = f)
```

```{r, cache = T}
f <- 0.9
#table <- simulate_by_f(f = f, M_max = M, ep_max = ep, draws = d)
#head(table)
#plot_f_table(table, f = f)
```


